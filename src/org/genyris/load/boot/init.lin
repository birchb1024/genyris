;; Copyright 2008 Peter William Birch <birchb@genyis.org>
;;
;; This software may be used and distributed according to the terms
;; of the Genyris License, in the file "LICENSE", incorporated herein by reference.
;;
@prefix g "http://www.genyris.org/lang/syntax#"
@prefix s "http://www.genyris.org/lang/system#"
@prefix u "http://www.genyris.org/lang/utilities#"

;
; Load extension functions
;
s.load-class-by-name "org.genyris.io.writerstream.WriterStream$AbstractWriterMethod"
s.load-class-by-name "org.genyris.io.file.Gfile"
s.load-class-by-name "org.genyris.string.AbstractStringMethod"
s.load-class-by-name "org.genyris.io.readerstream.ReaderStream"
s.load-class-by-name "org.genyris.io.parser.StreamParser"
s.load-class-by-name "org.genyris.io.StringFormatStream"
s.load-class-by-name "org.genyris.dl.ThingMethods"
s.load-class-by-name "org.genyris.io.sound.Sound$PlayMethod"
s.load-class-by-name "org.genyris.system.ExecMethod"

s.load-class-by-name "org.genyris.interp.builtin.ObjectFunction"
s.load-class-by-name "org.genyris.dl.TripleFunctions"
s.load-class-by-name "org.genyris.dl.TripleSetFunction"
s.load-class-by-name "org.genyris.logic.AbstractLogicFunction"
s.load-class-by-name "org.genyris.math.AbstractMathFunction"
s.load-class-by-name "org.genyris.format.AbstractFormatFunction"
s.load-class-by-name "org.genyris.task.TaskFunction"
s.load-class-by-name "org.genyris.web.HTTPgetFunction"

s.load-class-by-name "org.genyris.test.JunitRunnerFunction"

class g.Keyword(SimpleSymbol)
tag g.Keyword 'function
; Some aliases
defmacro define (var valu) (template (defvar ',var ,valu))
define function lambda
define var define
defmacro df (name args &rest body)
    template
        defvar ',name (lambdaq ,args ,@body)

defmacro setq (var valu) (template (set ',var ,valu))

defmacro if (test success-result failure-result)
   template
      cond
         ,test ,success-result
         else ,failure-result


defmacro do (&rest expression)
   expression

define else do
define then do

def null? (sexp)
   cond
      sexp nil
      else true

;
; Load source functions and classes
;
load "org/genyris/load/boot/assert.lin"
load "org/genyris/load/boot/pair.lin"
load "org/genyris/load/boot/alist.lin"
load "org/genyris/load/boot/object.lin"
load "org/genyris/load/boot/listoflines.lin"
load "org/genyris/load/boot/file.lin"
load "org/genyris/load/boot/util.lin"
load "org/genyris/load/boot/version.lin"
load "org/genyris/load/boot/set.lin"
load "org/genyris/load/boot/triple.lin"

@prefix ver "http://www.genyris.org/lang/version#"
; u.format "Version: ~a~%Date: ~a~%" ver.tip ver.tipdate

