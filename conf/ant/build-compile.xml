<project name="JLispin-Compile" basedir="../../">

  <macrodef name="macro-compile"
            description="general purpose macro for compiles">
    <attribute name="srcdir" />
    <attribute name="compiledir" />
    <attribute name="compileclasspath" />
    <sequential>
      <javac srcdir="@{srcdir}"
             destdir="@{compiledir}"
             source="${source}"
             optimize="${optimize}"
             deprecation="${deprecation}"
             nowarn="${nowarn}"
             debug="${debug}"
             debuglevel="${debuglevel}"
             includeAntRuntime="${includeAntRuntime}"
             fork="${fork}"
             executable="${javac.exec.path}">
        <classpath refid="@{compileclasspath}" />
      </javac>
    </sequential>
  </macrodef>

  <target name="-src-compile">
    <echo message="Compiling the source files from ${java.src.dir} to ${src.compile.dir}" />
    <macro-compile srcdir="${java.src.dir}"
                   compiledir="${src.compile.dir}"
                   compileclasspath="src.compile.classpath" />

    <!-- bring over all non-java resources into the classpath -->
    <copy todir="${src.compile.dir}" includeemptydirs="false">
      <fileset refid="src.config.files" />
    </copy>
  </target>

  <target name="-test-compile">
    <echo message="Compiling the test source files from ${test.src.dir} to ${test.compile.dir}" />
    <macro-compile srcdir="${test.src.dir}"
                   compiledir="${test.compile.dir}"
                   compileclasspath="test.classpath" />
	
    <copy todir="${test.compile.dir}" includeemptydirs="false">
		<fileset refid="src.config.files" />
		<fileset refid="test.config.files" />
	</copy>
  </target>


</project>
