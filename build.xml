<project name="Genyris" default="all" basedir=".">

    <property name="needed.lib.dir" value="needed" />
    <property name="junit.lib.dir" value="needed" />
    <property name="build.dir" value="build" />
    <property name="dist.dir" value="dist" />
    <property name="src.compile.dir" value="${build.dir}/classes" />
    <property name="src.dir" value="src" />

    <target name="all" depends="only-init, only-compile" description="Build all." />
    <target name="clean" depends="only-clean" />


    <!-- Libraries required  -->
    <fileset id="needed.libs" dir="${needed.lib.dir}">
        <include name="bsf.jar" />
        <include name="commons-logging-1.1.jar" />
        <include name="servlet-api.jar" />
    </fileset>

    <!-- Libraries required in the web classpath. -->
    <fileset id="web-inf.libs" dir="${needed.lib.dir}">
        <include name="bsf.jar" />
        <include name="commons-logging-1.1.jar" />
    </fileset>

    <!-- Servlet Libraries, release should not include these. -->
    <fileset id="servlet.libs" dir="${needed.lib.dir}">
        <include name="servlet-api.jar" />
    </fileset>

    <!-- Properties files from the classpath -->
    <fileset id="product.properties.files" dir="${java.src.dir}">
        <include name="*.properties" />
    </fileset>

    <!-- Classpath for JUnit testing -->
    <fileset id="junit.libs" file="${junit.lib.dir}/junit.jar" />


    <!-- ================================================================== -->
    <!--                        Classpaths                                  -->
    <!-- ================================================================== -->
    <path id="src.compile.classpath">
        <fileset refid="needed.libs" />
        <fileset refid="web-inf.libs" />
        <fileset refid="servlet.libs" />
        <fileset refid="junit.libs" />
    </path>

    <target name="only-init">
        <mkdir dir="${build.dir}" />
        <mkdir dir="${dist.dir}" />
        <mkdir dir="${src.compile.dir}" />
    </target>

    <target name="only-clean">
        <delete dir="${build.dir}" />
        <delete dir="${dist.dir}" />
    </target>

    <target name="only-compile">
        <javac srcdir="${src.dir}" destdir="${src.compile.dir}" classpathref="src.compile.classpath">
            <include name="org/**" />
        </javac>
    </target>

    <target name="only-binary-jar">
        <jar destfile="${dist.dir}/genyris-bin.jar" basedir=".">
            <fileset dir="${src.compile.dir}" includes="**/*.class" />
            <fileset dir="${src.dir}" includes="**/*.lin" />
            <fileset dir="${src.dir}" includes="**/*.properties" />
        </jar>
    </target>

    <target name="binary-jar" description="compile and create jar"
        depends="only-compile, only-binary-jar">
    </target>


</project>